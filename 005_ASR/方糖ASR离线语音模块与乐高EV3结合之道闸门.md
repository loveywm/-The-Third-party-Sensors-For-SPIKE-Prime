## 方糖ASR离线语音模块与乐高EV3结合之01道闸门



## 01 前言

因为教学当中用到EV3比较多，但是它缺少人工智能方面的扩展模块，如视觉识别，语音识别等。自己也给EV3做了一些外接语音模块，但都是固定语句，没有兼容乐高的外壳，自己一直很不爽，直到看到小喵家出了这个方糖ASR离线语音模块，我一下子就看重了，于是申请了内测并为它制作与乐高EV3结合的转接模块。

## 02 模块特点

详细的资料介绍小喵家论坛有，自己可以去看！


[方糖语音识别模块官方文档说明](https://www.yuque.com/kittenbot/hardwares/sugar-asr)


我主要说我看重的几点：

1. 外观兼容乐高尺寸:40x40x17mm，4个乐高插销孔
2. 提供统一的对外串口通信，这点比小喵家的视觉传感器好
3. 内置语句多，都是很实用的上课需要的
4. 支持自定义唤醒词和命令词（这个是最大亮点，也是我一直想要的）
5. 

## 03 制作转接模块

由于方糖语音识别模块开放串口输出协议，这样就方便做第三方转接了；再加上我对乐高传输协议比较了解，所以就很容易做一个转接模块把方糖语音识别模块识别输出的数字模拟乐高传感器的数字传给EV3，这样就可以像使用乐高传感器一样使用方糖语音识别模块了。



```

方糖语音识别模块-->协议转接模块-->乐高EV3

```
硬件连接如下：

方糖ASR串口接口| 转接模块接口
---|---
绿色TX | R
蓝色RX | T
红色5V | 5V
黑色GND | GND

其实只要按照PH2.00-4P接线直接插入就好了，我已经做成了防呆设计了。

![8f71d1f9cb567f289e6960919ffe373.jpg](https://note.youdao.com/yws/res/5/WEBRESOURCEc229d3d424fd51f70e1799bea5db4885)


## 04 软件协议编程

我把方糖内置的语句的ID编号转为EV3的超声波数值，对应如附录一表格。
软件上只要读取相应的数字进行判断就可以了

## 05 案例一 道闸门

### 05-01 案例功能

搭建一个道闸门，然后识别到开门语句就自动打开门，3秒后自动关闭！

### 05-02 搭建步骤

由于搭建比较简单，只放几张图片吧！

正面照片：

![c858f23a1be391923c2f6d7bc87ad33.jpg](https://note.youdao.com/yws/res/6/WEBRESOURCE432c6efd341d5864c7c078bfddb346e6)

侧面45度照片：

![589c7876181f376bc5e581c5f92bd20.jpg](https://note.youdao.com/yws/res/f/WEBRESOURCE5060bf9fdee0b8306c5e1017fa550e3f)


### 05-03 程序控制

开门的语句编号是30，所以只要在编程中超声波数值识别到30就做对应动作就可以了！

在老版软件EV3-G上的编程代码如下：

![002.png](https://note.youdao.com/yws/res/e/WEBRESOURCEe55a37bd60e9b1fa4b04323159a90c3e)

在新版Classroom上的编程代码如下：

![001.png](https://note.youdao.com/yws/res/f/WEBRESOURCE79897ca953612718bd2a08d79d0230ff)


### 05-04 演示视频


[案例演示视频](https://www.bilibili.com/video/BV12L411A7Lq/)






###  附录一 ASR离线语音识别模块的内置语句编号

语句编号 | 内置语句 | 备注
---|---|---
01 | 智能管家/小喵小喵/你好小喵 | 内置固定唤醒词
01 | 自定义唤醒词 | 需要先进行自定义唤醒词学习
 | |
20| 打开台灯/开灯 |唤醒词唤醒后方可使用
21| 关闭台灯/关灯 |
22| 亮一点 |
23| 暗一点 |
24| 亮红灯 |
25| 亮绿灯 |
26| 亮黄灯 |
27| 亮蓝灯 |
28| 打开所有灯 |
29| 关闭所有灯 |
| |
30| 开门 |
31| 关门 |
32| 打开窗户 |
33| 关闭窗户 |
34| 打开窗帘|
35| 关闭窗帘 |
36| 打开空调 |
37| 关闭空调 |
38| 打开风扇 |
39| 关闭风扇 |
| |
40| 查询温度 |
41| 查询湿度 |
42| 查询天气 |
43| 现在时间 |
44| 今天日期|
45| 测量距离 |
46| 测量体温 |
47| 测试重量 |
48| 测量身高 |
| |
50| 播放音乐 |
51| 停止音乐 |
52| 暂停音乐 |
53| 上一首 |
54| 下一首|
55| 增大音量 |
56| 减小音量 |
57| 快一点 |
58| 慢一点 |
59| 启动电梯 |
| |
60| 启动机器人 |
61| 关闭机器人 |
62| 停止机器人 |
63| 前进 |
64| 后退|
65| 左转 |
66| 右转 |
67| 去一楼 |
68| 去二楼 |
69| 去三楼 |
| |
70| 晾衣服 |
71| 收衣服 |
| |
80| 打开客厅灯 |
81| 关闭客厅灯 |
82| 打开厨房灯 |
83| 关闭厨房灯 |
84| 打开卧室灯|
85| 关闭卧室灯 |
86| 打开阳台灯 |
87| 关闭阳台灯 |
88| 打开浴室灯 |
89| 关闭浴室灯 |
| |
90| 第一条命令词 |需要先进行自定义命令词学习
91| 第二条命令词 |需要先进行自定义命令词学习
92| 第三条命令词 |需要先进行自定义命令词学习
93| 第四条命令词 |需要先进行自定义命令词学习
94| 第五条命令词 |需要先进行自定义命令词学习
95| 第六条命令词 |需要先进行自定义命令词学习
96| 第七条命令词 |需要先进行自定义命令词学习
97| 第八条命令词 |需要先进行自定义命令词学习
98| 第九条命令词 |需要先进行自定义命令词学习
99| 第十条命令词 |需要先进行自定义命令词学习








